{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %} DiNaMe {% endblock title %}

{% block navitems %}
{% if user.is_staff %}
<li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
       aria-expanded="false">
        Parametres
    </a>
    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
        <li><a class="dropdown-item" href="{% url 'snb_list' %}">SNB...</a></li>
    </ul>
</li>
{% endif %}
{% endblock navitems %}

{% block content %}


<div class="row d-flex">
    <h3 class="h3 bg-secondary text-light text-center" >Calculette DiNaMe</h3>
</div>

<div class="row mt-4 d-flex justify-content-center">
    <div class="col-md-4 col-lg-6">

    <form action="#scroll" method="post" class="form">
        {% csrf_token %}
        <div class="row d-flex justify-content-between ">
        <div class="col-lg-12 col-md-12">
            <div class="card-group">
                <div class="col-lg-12 col-sm-12">
                    <div class="card text-white mt-4 mb-1 mx-1 w-90 bg-secondary">
                        <div  class="card-header h4">Votre situation</div>
                        <div class="card-body d-flex">
                            <div class="col-lg-5 mx-3">
                                {{ form.Nr|as_crispy_field }}
                                {{ form.echelon|as_crispy_field }}
                            </div>
                            <div class="col-lg-5 mx-3">
                                {{ form.tps_trav|as_crispy_field }}
                                {{ form.maj_res|as_crispy_field }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-group">
                <div class="col-lg-12 col-sm-12">
                    <div class="card text-white mt-4 mb-1 mx-1 w-90 bg-secondary">
                        <div  class="card-header h4">Article 30</div>
                        <div class="card-body d-flex">
                            <div class="col-lg-6">
                                {{ form.art30|as_crispy_field }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-group">
                <div class="col-lg-6 col-sm-12">
                    <div class="card h-100 text-white mt-4 mb-1 mx-1 w-90 bg-secondary">
                        <div  class="card-header h4">AMG</div>
                        <div class="card-body">

                            {{ form.eligible_AMG|as_crispy_field }}
                            {{ form.famille|as_crispy_field }}
                            {{ form.site_origine|as_crispy_field }}
                            {{ form.site_destination|as_crispy_field }}

                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-sm-12">
                    <div class="card h-100 text-white mt-4 mb-1 mx-1 w-90 bg-secondary">
                        <div  class="card-header h4">Logement</div>
                        <div class="card-body">
                            <p>La surface correspondant à votre composition familiale est fixée à :
                                <strong>{{ surface }}</strong> m2

                            <p>L'écart de loyer entre l'ancienne et la nouvelle localisation est de :
                            <strong>{{ ecart_loyer }}</strong> € par m2 par mois, ce qui correspond à une indemnisation de
                            <strong>{{ indemnisation_loyer }}</strong> € sur 5 ans</p>
                            <p>En complément l'AMG vous permet d'obtenir une prime de 5 mois de salaire soit
                            <strong>{{ prime_amg }}</strong> € </p>
                        </div>
                    </div>
                </div>
<!--                <div class="card-group mt-4">-->
                <div class="col-lg-12 col-sm-12 mt-4">
                    <div class="card h-100 text-white mt-4 mb-1 mx-1 w-90">
                        <div  class="card-header h4 {{ attractivite }}">MGES</div>
                        <div class="card-body bg-secondary">
                            <p>Le site destination est considéré comme
                            <strong>{{ lbl_MGES}}</strong>
                            <p>et ajoute <strong>{{ moisMGES }}</strong> mois de salaire</p>
                        </div>
                    </div>
<!--                </div>-->
                </div>
            </div>
             <div class="card-group mt-4">
                <div class="col-lg-12 col-sm-12">
                    <div class="card text-white mt-4 mb-1 mx-1 w-90 bg-secondary">
                        <div  class="card-header h4">MGEE</div>
                        <div class="card-body d-flex">
                            <div class="col-lg-6">
                                {{ form.eligible_MGEE|as_crispy_field }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="d-flex justify-content-end" >
                <input id="fetch-call" type="submit" value="Calculer" class="btn btn-primary mt-3" />
            </div>
        </div>
    </div>
    </form>


<!--    <p>Salaire Mensuel : {{ salaire_mensuel }}</p>-->
<!--    <p>Salaire Plancher : {{ plancher }}</p>-->
<!--    <p>Salaire Plafond : {{ plafond }}</p>-->
<!--    <p>Salaire retenu DiNaMe : {{ base_diname }}</p>-->
<!--    <p>Surface retenue : {{ surface }}</p>-->
<!--    <p>Base loyer origine par m2 : {{ loyer_origine }}</p>-->
<!--    <p>Base loyer destination par m2 : {{ loyer_destination }}</p>-->
<!--    <p>Ecart Loyer retenu : {{ ecart_loyer }}</p>-->
<!--    <p>Le site destination est considéré comme : {{ lbl_MGES}} et ajoute {{ moisMGES }} mois de salaire</p>-->
<!--    <p>Indemnité d'écart de loyer sur  5 ans: {{ indemnisation_loyer }}</p>-->
<!--    <p>Prime "Article 30" : {{ ind_art30 }}</p>-->
<!--    <p>Prime AMG sur 5 ans : {{ prime_amg }}</p>-->
<!--    <p>Prime MGES : {{ prime_MGES }}</p>-->
<!--    <p>Mois MGEE  : {{ mois_MGEE }}</p>-->
<!--    <p>Prime MGEE : {{ prime_MGEE }}</p>-->




</div>
      <div class="col-sm-6 " id="scroll">
        <table class="table table-striped table-hover table-sm">
            <thead>
            <tr>
                <th scope="col">Item</th>
                <th class="text-center" scope="col">Nb Mois</th>
                <th scope="col">Base</th>
                <th scope="col">Total</th>
            </tr>
            </thead>
            <thead>
            <tr>
                <th scope="col">Statut</th>
                <th class="text-center" scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td scope="row">Article 30</td>
                <td class="text-center">2</td>
                <td>{{ salaire_mensuel }}</td>
                <td>{{ ind_art30 }}</td>
            </tr>
            <thead>
            <tr>
                <th scope="col">DiNaMe</th>
                <th class="text-center" scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr>
            </thead>
            <tr>
                <td scope="row">AMG</td>
                <td class="text-center">5</td>
                <td>{{ base_diname }}</td>
                <td>{{ prime_amg }}</td>
            </tr>
            <tr>
                <td scope="row">MGES</td>
                <td class="text-center">{{ moisMGES }}</td>
                <td>{{ base_diname }}</td>
                <td>{{ prime_MGES }}</td>
            </tr>
            <tr>
                <td scope="row">MGEE</td>
                <td class="text-center">{{ mois_MGEE }}</td>
                <td>{{ base_diname }}</td>
                <td>{{ prime_MGEE }}</td>
            </tr>
            <thead>
            <tr>
                <th scope="col">Surface</th>
                <th class="text-center" scope="col">M2</th>
                <th scope="col">Ecart/m2</th>
                <th scope="col">Total/5ans</th>
            </tr>
            </thead>
            <tr>
                <td scope="row">Ecart Loyer</td>
                <td class="text-center">{{ surface }}</td>
                <td>{{ ecart_loyer }}</td>
                <td>{{ indemnisation_loyer }}</td>
            </tr>
            </tbody>

        </table>
   </div>
</div>

<!--<script defer src="{% static 'js/script_snb.js' %}"></script>-->
{% endblock content %}

